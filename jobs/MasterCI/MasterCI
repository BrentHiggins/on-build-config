node{
    deleteDir()
    checkout scm
    stage("Create Manifest"){
        load("jobs/create_manifest/create_manifest.groovy")
        def manifest_name=env.MANIFEST_FILE_URL.tokenize('/')[-1];
        currentBuild.description = "<a href=${env.MANIFEST_FILE_URL}>${manifest_name}</a>";
    }

    stage("Test"){
        build job: 'Continuous-Test/Continuous-Functional', parameters: [string(name: 'MANIFEST_FILE_URL', value: env.MANIFEST_FILE_URL), booleanParam(name: 'IS_OFFICIAL_RELEASE', value: env.IS_OFFICIAL_RELEASE=="true")];
    }

    def shareMethod = load("jobs/shareMethod.groovy")
    shareMethod.buildAndPublish()
}
